#encoding=utf-8

import re
import requests
import threading
import sys
reload(sys)
sys.setdefaultencoding('utf-8')

class mythread(threading.Thread):
    def __init__(self, name, url, limit):
        threading.Thread.__init__(self)
        self.name = name
        self.url = url
        self.limit = limit
    def run(self):
        try:
            headers = {
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36'
            }
            start = 0000
            while start <= self.limit:
                url = self.url
                url = url + str(start)
                print url[-4:]
                response = requests.get(url, headers=headers)
                response.encoding = 'utf-8'
                t = response.text
                f = open(unicode(r'D:/txt/%s.txt' % self.name), 'a+')
                f.write(t)
                start += 30
            f.close()
            f1 = open(unicode(r'D:/txt/%s.txt'%self.name), 'r')
            f2 = open(unicode(r'D:/txt/%s1.txt'%self.name), 'a+')
            str1 = f1.read()
            str11 = str1.decode('utf-8')
            str2 = '(\s+<td>.+?</td>\s+<td>.+?</td>\s+<td>.+邻水.+</td>\s+<td>.+?</td>)'
            str3 = r'((?:\s+<td>.+?</td>)+)'
            r = re.findall(str2, str1)
            print len(r)
            for i in range(len(r)):
                f2.write(r[i])
            f1.close()
            f2.close()
        except Exception:
            print '线程出错'

threads=[]
t1=mythread('北京大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476733931&lx=1&start=',1710)
t2=mythread('中国人民大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476733949&lx=1&start=',5250)
t3=mythread('清华大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476733969&lx=1&start=',1170)
t4=mythread('北京工业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734067&lx=1&start=',240)
t5=mythread('北京航空航天大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734095&lx=1&start=',1140)
t6=mythread('北京理工大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734127&lx=1&start=',1020)
t7=mythread('北京科技大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734158&lx=1&start=',630)
t8=mythread('北京邮电大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736351&lx=1&start=',900)
t9=mythread('北京林业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736617&lx=1&start=',1020)
t10=mythread('北京中医药大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736760&lx=1&start=',510)
t11=mythread('北京师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736792&lx=1&start=',1410)
t12=mythread('中国传媒大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737059&lx=1&start=',4200)
t13=mythread('中央财经大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737096&lx=1&start=',480)
t14=mythread('对外经济贸易大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476738465&lx=1&start=',1080)
t15=mythread('华北电力大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734760&lx=1&start=',1260)
t16=mythread('南开大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476738698&lx=1&start=',1080)
t17=mythread('天津大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737624&lx=1&start=',570)
t18=mythread('大连理工大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476739904&lx=1&start=',690)
t19=mythread('东北大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476740115&lx=1&start=',2010)
t20=mythread('大连海事大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742379&lx=1&start=',540)
t21=mythread('吉林大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476743360&lx=1&start=',390)
t22=mythread('哈尔滨工业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476740075&lx=1&start=',3510)
t23=mythread('哈尔滨工程大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476744079&lx=1&start=',1440)
t24=mythread('复旦大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742384&lx=1&start=',750)
t25=mythread('上海交通大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741299&lx=1&start=',1530)
t26=mythread('华东理工大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742435&lx=1&start=',1950)
t27=mythread('东华大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742507&lx=1&start=',2310)
t28=mythread('华东师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742586&lx=1&start=',1980)
t29=mythread('上海外国语大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741494&lx=1&start=',480)
t30=mythread('上海大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741622&lx=1&start=',300)
t31=mythread('南京大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741659&lx=1&start=',630)
t32=mythread('苏州大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741691&lx=1&start=',1920)
t33=mythread('东南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741729&lx=1&start=',3660)
t34=mythread('南京航空航天大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742867&lx=1&start=',1830)
t35=mythread('中国矿业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476742916&lx=1&start=',270)
t36=mythread('河海大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741884&lx=1&start=',2430)
t37=mythread('江南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476741923&lx=1&start=',240)
t38=mythread('南京农业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736974&lx=1&start=',810)
t39=mythread('中国药科大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476745718&lx=1&start=',420)
t40=mythread('南京师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476745757&lx=1&start=',300)
t41=mythread('浙江大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476746061&lx=1&start=',1260)
t42=mythread('中国科学技术大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476748467&lx=1&start=',900)
t43=mythread('合肥工业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476743213&lx=1&start=',750)
t44=mythread('厦门大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476743450&lx=1&start=',900)
t45=mythread('山东大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476749380&lx=1&start=',2790)
t46=mythread('中国海洋大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476749413&lx=1&start=',1140)
t47=mythread('中国石油大学华东','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476734863&lx=1&start=',1170)
t48=mythread('郑州大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476748122&lx=1&start=',960)
t49=mythread('华中科技大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737030&lx=1&start=',4650)
t50=mythread('中国地质大学武汉','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476750912&lx=1&start=',3540)
t51=mythread('武汉理工大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476750981&lx=1&start=',4290)
t52=mythread('华中农业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751025&lx=1&start=',1590)
t53=mythread('华中师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751046&lx=1&start=',1380)
t54=mythread('中南财经政法大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751145&lx=1&start=',4080)
t55=mythread('湖南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476744598&lx=1&start=',4560)
t56=mythread('中南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751271&lx=1&start=',2070)
t57=mythread('湖南师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751364&lx=1&start=',2430)
t58=mythread('华南理工大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476751568&lx=1&start=',2610)
t59=mythread('广西大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737258&lx=1&start=',270)
t60=mythread('四川大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476754340&lx=1&start=',3300)
t61=mythread('重庆大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476754373&lx=1&start=',2610)
t62=mythread('西南交通大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736853&lx=1&start=',2370)
t63=mythread('电子科技大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476736882&lx=1&start=',1620)
t64=mythread('四川农业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476754534&lx=1&start=',510)
t65=mythread('西南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476737346&lx=1&start=',7020)
t66=mythread('西南财经大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476754913&lx=1&start=',720)
t67=mythread('西南政法大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476754946&lx=1&start=',780)
t68=mythread('贵州大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755123&lx=1&start=',480)
t69=mythread('云南大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755429&lx=1&start=',180)
t70=mythread('西北大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755697&lx=1&start=',270)
t71=mythread('西安交通大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755721&lx=1&start=',3180)
t72=mythread('西北工业大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755736&lx=1&start=',300)
t73=mythread('西安电子科技大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755774&lx=1&start=',1170)
t74=mythread('长安大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476755901&lx=1&start=',150)
t75=mythread('西北农林科技大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476746337&lx=1&start=',120)
t76=mythread('陕西师范大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476746360&lx=1&start=',150)
t77=mythread('兰州大学','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476756191&lx=1&start=',11430)
t78=mythread('中国石油大学北京','https://gaokao.chsi.com.cn/zzbm/mdgs/detail.action?oid=476739996&lx=1&start=',810)
t1.start()
t2.start()
t3.start()
t4.start()
t5.start()
t6.start()
t7.start()
t8.start()
t9.start()
t10.start()
t11.start()
t12.start()
t13.start()
t14.start()
t15.start()
t16.start()
t17.start()
t18.start()
t19.start()
t20.start()
t21.start()
t22.start()
t23.start()
t24.start()
t25.start()
t26.start()
t27.start()
t28.start()
t29.start()
t30.start()
t31.start()
t32.start()
t33.start()
t34.start()
t35.start()
t36.start()
t37.start()
t38.start()
t39.start()
t40.start()
t41.start()
t42.start()
t43.start()
t44.start()
t45.start()
t46.start()
t47.start()
t48.start()
t49.start()
t50.start()
t51.start()
t52.start()
t53.start()
t54.start()
t55.start()
t56.start()
t57.start()
t58.start()
t59.start()
t60.start()
t61.start()
t62.start()
t63.start()
t64.start()
t65.start()
t66.start()
t67.start()
t68.start()
t69.start()
t70.start()
t71.start()
t72.start()
t73.start()
t74.start()
t75.start()
t76.start()
t77.start()
t78.start()